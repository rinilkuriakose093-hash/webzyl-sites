# PHASE 4 - ENVIRONMENT CONFIGURATION
# Copy this file to .env and fill in the values

# =============================================================================
# GOOGLE SHEETS CONFIGURATION
# =============================================================================

# Your Google Spreadsheet ID
# Find it in URL: https://docs.google.com/spreadsheets/d/[SPREADSHEET_ID]/edit
SPREADSHEET_ID=

# Optional: Email for booking notifications
NOTIFICATION_EMAIL=

# =============================================================================
# GOOGLE APPS SCRIPT CONFIGURATION
# =============================================================================

# Apps Script Web App URL (after deployment)
# Format: https://script.google.com/macros/s/[SCRIPT_ID]/exec
BOOKING_WEBHOOK_URL=

# HMAC Secret for signing requests (generate with: openssl rand -hex 32)
# CRITICAL: Must be same in both Apps Script and Cloudflare Worker
BOOKING_HMAC_SECRET=

# =============================================================================
# CLOUDFLARE WORKER CONFIGURATION
# =============================================================================

# Your Cloudflare account ID
CLOUDFLARE_ACCOUNT_ID=

# Your worker name
WORKER_NAME=resort-booking-api

# KV Namespace ID (your existing RESORT_CONFIGS namespace)
KV_NAMESPACE_ID=

# Worker route (your custom domain)
WORKER_ROUTE=https://your-domain.com/*

# =============================================================================
# CLOUDFLARE WORKER ENVIRONMENT VARIABLES (Set in Dashboard)
# =============================================================================

# These need to be set in Cloudflare Dashboard → Worker → Settings → Variables
# Variable name: BOOKING_WEBHOOK_URL
# Value: [Your Apps Script Web App URL]

# Variable name: BOOKING_HMAC_SECRET  
# Value: [Same HMAC secret as Apps Script]

# =============================================================================
# DEPLOYMENT COMMANDS
# =============================================================================

# 1. Generate HMAC Secret
#    openssl rand -hex 32
#    Copy output and paste as BOOKING_HMAC_SECRET above

# 2. Deploy Apps Script
#    - Go to https://script.google.com
#    - Create new project
#    - Paste code from google-apps-script-booking-sink.js
#    - Update SPREADSHEET_ID in code
#    - Set Script Properties: BOOKING_HMAC_SECRET
#    - Deploy as Web App
#    - Copy Web App URL → BOOKING_WEBHOOK_URL

# 3. Deploy Cloudflare Worker
#    wrangler deploy
#    - Or use Dashboard to upload worker code
#    - Set environment variables
#    - Bind KV namespace

# 4. Test
#    curl -X POST https://your-worker.workers.dev/api/booking \
#      -H "Content-Type: application/json" \
#      -d '{"slug":"test","name":"Test User","phone":"1234567890","checkIn":"2025-02-01","checkOut":"2025-02-03","guests":2}'

# =============================================================================
# SECURITY NOTES
# =============================================================================

# ⚠️ NEVER commit this file with real values to version control
# ⚠️ Use different HMAC secrets for dev/staging/production
# ⚠️ Rotate HMAC secret if compromised
# ⚠️ Keep Apps Script Web App URL private (only Worker should know it)
# ⚠️ Review Apps Script execution logs regularly for anomalies

# =============================================================================
# RATE LIMITING CONFIGURATION (Optional)
# =============================================================================

# Maximum requests per IP per slug per hour
RATE_LIMIT_MAX_REQUESTS=5

# Time window in minutes
RATE_LIMIT_WINDOW_MINUTES=60

# =============================================================================
# BOOKING MODE DEFAULTS
# =============================================================================

# Default booking mode if not specified in config
# Options: sheet | whatsapp | both
DEFAULT_BOOKING_MODE=sheet

# Default WhatsApp template
DEFAULT_WHATSAPP_TEMPLATE="Hi, I want to enquire about {{room}} from {{checkIn}} to {{checkOut}} for {{guests}} guests. {{notes}}"

# =============================================================================
# MONITORING & ALERTING (Optional)
# =============================================================================

# Sentry DSN for error tracking (optional)
SENTRY_DSN=

# Slack webhook for booking notifications (optional)
SLACK_WEBHOOK_URL=

# Google Analytics tracking ID (optional)
GA_TRACKING_ID=

# =============================================================================
# MAINTENANCE SETTINGS
# =============================================================================

# Auto-archive sheets older than X months
AUTO_ARCHIVE_MONTHS=3

# Maximum rows per sheet before creating new month
MAX_ROWS_PER_SHEET=50000

# =============================================================================
# FEATURE FLAGS
# =============================================================================

# Enable/disable email notifications
ENABLE_EMAIL_NOTIFICATIONS=false

# Enable/disable Slack notifications
ENABLE_SLACK_NOTIFICATIONS=false

# Enable/disable rate limiting
ENABLE_RATE_LIMITING=true

# Enable/disable honeypot anti-spam
ENABLE_HONEYPOT=true

# Enable/disable HMAC verification (disable only for testing)
ENABLE_HMAC_VERIFICATION=true

# =============================================================================
# BACKUP & RECOVERY
# =============================================================================

# Backup spreadsheet ID (optional - for redundancy)
BACKUP_SPREADSHEET_ID=

# Backup frequency (hours)
BACKUP_FREQUENCY_HOURS=24
